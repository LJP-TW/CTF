#!/usr/bin/python3.8
import math

c = 576472001749435197691172982911534306327216538728541805305339071165184424538551720529728871254550930556981525964786774372062607857148128441211282764104932572518387661316802751083764743685571123471864506490666178129547824784989126298044423291434931834242799467874782178584757489909980414416085731463352094015432533203
e = 65537
n = 27622427294580294359666751530938323126175923866458484493773260993883041565203837220445242753617974423991119399062053591900030346690255522939375319613215609982937851395811602398146239366310540508600464350078897283229449069793560891500283709650730286964632838848155101648641468775824815385338475640984295198376597358261

def pollard(n):
    a = 2
    b = 2
    while True:
        a = pow(a, b, n)
        d = math.gcd(a-1, n)
        if 1 < d < n: return d
        b += 1

p = pollard(n)
q = n // p

print('p : {}'.format(p))
print('q : {}'.format(q))

phiN = (p - 1) * (q - 1)
d = pow(e, -1, phiN)
m = pow(c, d, n)

print('d : {}'.format(d))
print('m : {}'.format(m))

flag = bytes.fromhex(hex(m)[2:]).decode('utf-8')

print('flag: {}'.format(flag))

'''
p : 75124430132727221915660895451796585394905552641956439471501849089081101123804938375347632670466815630698548636042192579629224225220426135853123660839464564579
q : 367689009364569602961193911305281937994283676621249151629885301888449984095306097574700365126004185510360542351303826754337129199233331567604073191178867613959
d : 6500039271511013620012826984911283996092056363100580555456783664916982269841060433246967876867973840224469282578314394834708149696463382131788854831240537973206562329100801387780344670604902432762077679985650812151898483482320088995044707170177491547544011186334966147649395323135651622148772754818543886621864986217
m : 28918866808818069421216779551759992807843501386184062948330387837
'''

